{% extends 'core/base.html' %}
{% load embed_video_tags %}

{% block title %}{{ game.title }}{% endblock %}

{% block content %}
<div style="margin-top: 20px;">
    <a href="{% url 'library:game_list' %}" style="color: #888; text-decoration: none;">&larr; Back to Library</a>

    <div style="display: flex; gap: 40px; margin-top: 20px; flex-wrap: wrap;">

        <div style="flex: 1; min-width: 300px;">
            <div style="border: 2px solid #333; padding: 10px; background: #000;">
                {% if game.box_art %}
                    <img src="{{ game.box_art.url }}" alt="{{ game.title }}" style="width: 100%; display: block;">
                {% else %}
                    <div style="height: 400px; background: #222; display: flex; align-items: center; justify-content: center;">No Art</div>
                {% endif %}
            </div>

            <table style="width: 100%; margin-top: 20px; border-collapse: collapse; font-size: 0.9rem;">
                <tr style="border-bottom: 1px solid #333;">
                    <td style="padding: 10px; color: #888;">Platform</td>
                    <td style="padding: 10px; text-align: right;">{{ game.platform.name }}</td>
                </tr>
                <tr style="border-bottom: 1px solid #333;">
                    <td style="padding: 10px; color: #888;">Region</td>
                    <td style="padding: 10px; text-align: right;">{{ game.get_region_display }}</td>
                </tr>
                <tr style="border-bottom: 1px solid #333;">
                    <td style="padding: 10px; color: #888;">Condition</td>
                    <td style="padding: 10px; text-align: right; color: var(--secondary);">{{ game.get_condition_display }}</td>
                </tr>
                <tr>
                    <td style="padding: 10px; color: #888;">Status</td>
                    <td style="padding: 10px; text-align: right;">{{ game.get_ownership_status_display }}</td>
                </tr>
            </table>
        </div>

        <div style="flex: 2; min-width: 300px;">
            <h1 style="margin-top: 0; font-size: 2rem;">{{ game.title }}</h1>

            <div style="margin-bottom: 20px;">
                {% for genre in game.genres.all %}
                    <span style="background: var(--primary); color: #000; padding: 2px 8px; font-size: 0.7rem; font-weight: bold; margin-right: 5px;">{{ genre.name }}</span>
                {% endfor %}
            </div>

            <div style="font-size: 1.1rem; line-height: 1.8; color: #ccc;">
                {{ game.description|linebreaks }}
            </div>

            {% if game.video_review %}
                <div style="margin-top: 40px;">
                    <h3 class="retro-font" style="font-size: 1rem; border-bottom: 1px solid #333; padding-bottom: 10px;">Video Review</h3>

                    <div class="video-wrapper">
                        {% video game.video_review '100% x 100%' %}
                    </div>

                    <style>
                        .video-wrapper {
                            position: relative;
                            padding-bottom: 56.25%; /* 16:9 Ratio */
                            height: 0;
                            overflow: hidden;
                            background: #000;
                            border: 2px solid #333;
                        }
                        .video-wrapper iframe {
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            z-index: 1000
                        }
                    </style>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}